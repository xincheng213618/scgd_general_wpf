# ColorVision.Scheduler

## 🎯 功能定位

任务调度系统，基于Quartz.NET实现的定时任务管理组件。

## 作用范围

UI调度模块，为用户提供任务计划、定时执行、监控管理等功能。

## 主要功能点

### 核心功能
- **任务计划管理** - 创建、编辑、删除定时任务
- **Cron表达式支持** - 灵活的时间配置，支持复杂的执行计划
- **任务监控** - 实时查看任务执行状态和历史记录
- **执行策略** - 立即执行、延迟执行、重复执行等多种模式
- **失败重试** - 任务失败时的自动重试机制
- **日志记录** - 详细的任务执行日志和错误信息
- **UI界面** - 用户友好的任务管理界面

### 增强功能 (v1.3.8.3+)
- **任务优先级** - 支持1-10级优先级设置，优先级高的任务优先执行
- **执行统计** - 自动统计成功/失败次数、执行时间（平均/最大/最小）
- **搜索过滤** - 按任务名称、分组名称、状态实时过滤任务
- **批量操作** - 支持多选任务进行批量启动、暂停、删除
- **数据导出** - 支持导出CSV（Excel兼容）、JSON配置、统计报告
- **任务恢复健壮性** - 启动时自动恢复历史任务，遇到类型丢失或异常任务会自动跳过并弹窗提示，保证系统整体可用性
- **任务管理右键菜单** - 支持编辑、查看属性、暂停、继续、删除、立即执行等操作，提升任务管理体验
- **异常处理与用户提示** - 调度器增强了异常捕获和用户提示，提升健壮性和易用性
- **结构化日志** - 集成Microsoft.Extensions.Logging，支持多种日志输出方式

## 与主程序的依赖关系

**被引用方式**:
- ColorVision 主程序集成调度界面
- 通过菜单或插件方式加载

**引用的程序集**:
- Quartz.NET - 任务调度核心库
- ColorVision.Common - 通用接口和基类

## 使用方式

### 引用方式
```xml
<ProjectReference Include="..\ColorVision.Scheduler\ColorVision.Scheduler.csproj" />
```

### 在主程序中的启用
- 通过任务计划程序菜单打开
- 支持后台服务模式运行

## 开发调试

```bash
dotnet build UI/ColorVision.Scheduler/ColorVision.Scheduler.csproj
```

## 目录说明

- 包含Quartz.NET封装和调度UI控件
- 任务配置和监控界面实现

## 相关文档链接

- [任务调度使用指南](../../docs/ui-components/UI组件概览.md)
- [入门指南](../../docs/getting-started/入门指南.md)

## 维护者

ColorVision UI团队