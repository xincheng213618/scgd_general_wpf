<Window x:Class="ColorVision.Database.SqliteLog.SqliteLogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ColorVision.Database.SqliteLog"
        xmlns:properties="clr-namespace:ColorVision.Database.Properties"
        mc:Ignorable="d"
        Title="{x:Static properties:Resources.SqliteLogWindow}" Height="700" Width="1200" 
        Background="{DynamicResource GlobalBackground}" Initialized="Window_Initialized">
    <Window.Resources>
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="{DynamicResource GlobalTextBrush}"/>
        </Style>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Toolbar -->
        <Grid Margin="5,5,5,5">
            <ToolBarTray Grid.Row="0" IsLocked="True">
                <ToolBar Padding="3,2">
                    <Button Content="{x:Static properties:Resources.Query}" Click="Query_Click" Margin="2,0,0,0"/>
                    <Button Content="{x:Static properties:Resources.Refresh}" Click="Refresh_Click" Margin="2,0,0,0"/>
                    <Separator Margin="5,0"/>
                    <Button Content="{x:Static properties:Resources.ClearCache}" Click="ClearCache_Click" Margin="2,0,0,0"/>
                    <Button Content="{x:Static properties:Resources.OpenFolder}" Click="OpenFolder_Click" Margin="2,0,0,0"/>
                    <Separator Margin="5,0"/>
                    <TextBlock Text="{x:Static properties:Resources.DataSource}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <ComboBox x:Name="DataSourceComboBox" Width="260" VerticalAlignment="Center" SelectionChanged="DataSourceComboBox_SelectionChanged"/>
                    <Separator Margin="5,0"/>
                    <ToggleButton x:Name="ToggleDetailPanel" Content="{x:Static properties:Resources.ShowDetail}" IsChecked="True" Click="ToggleDetailPanel_Click" Margin="2,0,0,0"/>
                </ToolBar>
            </ToolBarTray>
        </Grid>
        
        <!-- Query Panel -->
        <Border Grid.Row="1" Margin="5,0,5,5" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{x:Static properties:Resources.Level}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <ComboBox x:Name="LevelComboBox" Grid.Column="1" VerticalAlignment="Center" Margin="0,0,10,0">
                    <ComboBoxItem Content="" IsSelected="True"/>
                    <ComboBoxItem Content="DEBUG"/>
                    <ComboBoxItem Content="INFO"/>
                    <ComboBoxItem Content="WARN"/>
                    <ComboBoxItem Content="ERROR"/>
                    <ComboBoxItem Content="FATAL"/>
                </ComboBox>
                <TextBlock Grid.Column="2" Text="{x:Static properties:Resources.Logger}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox x:Name="LoggerTextBox" Grid.Column="3" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Grid.Column="4" Text="{x:Static properties:Resources.Message}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox x:Name="MessageTextBox" Grid.Column="5" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Grid.Column="6" Text="{x:Static properties:Resources.StartDate}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <DatePicker x:Name="StartDatePicker" Grid.Column="7" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Grid.Column="8" Text="{x:Static properties:Resources.EndDate}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <DatePicker x:Name="EndDatePicker" Grid.Column="9" VerticalAlignment="Center"/>
            </Grid>
        </Border>
        
        <!-- Main Content Area with Detail Panel -->
        <Grid Grid.Row="2" Margin="5,0,5,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition x:Name="DetailColumn" Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- DataGrid -->
            <DataGrid x:Name="LogDataGrid" Grid.Column="0"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      Background="Transparent" BorderThickness="1"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      CanUserSortColumns="True" CanUserReorderColumns="True"
                      GridLinesVisibility="Horizontal"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      SelectionChanged="LogDataGrid_SelectionChanged">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="60"/>
                    <DataGridTextColumn Header="{x:Static properties:Resources.Date}" Binding="{Binding Date, StringFormat=yyyy-MM-dd HH:mm:ss}" Width="150"/>
                    <DataGridTextColumn Header="{x:Static properties:Resources.Level}" Binding="{Binding Level}" Width="80"/>
                    <DataGridTextColumn Header="{x:Static properties:Resources.Thread}" Binding="{Binding Thread}" Width="80"/>
                    <DataGridTextColumn Header="{x:Static properties:Resources.Logger}" Binding="{Binding Logger}" Width="200"/>
                    <DataGridTextColumn Header="{x:Static properties:Resources.Message}" Binding="{Binding Message}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
            
            <!-- GridSplitter -->
            <GridSplitter x:Name="DetailSplitter" Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="Transparent" 
                          Visibility="{Binding IsChecked, ElementName=ToggleDetailPanel, Converter={StaticResource BoolToVisibility}}"
                          DragCompleted="DetailSplitter_DragCompleted"/>
            
            <!-- Detail Panel -->
            <Border x:Name="DetailPanel" Grid.Column="2" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Padding="10"
                    Visibility="{Binding IsChecked, ElementName=ToggleDetailPanel, Converter={StaticResource BoolToVisibility}}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="{x:Static properties:Resources.DetailInfo}" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                        
                        <TextBlock Text="Id:" FontWeight="Bold" Margin="0,5,0,2"/>
                        <TextBlock x:Name="DetailId" TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Date}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBlock x:Name="DetailDate" TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Level}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBlock x:Name="DetailLevel" TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Thread}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBlock x:Name="DetailThread" TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Logger}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBlock x:Name="DetailLogger" TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Message}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBox x:Name="DetailMessage" TextWrapping="Wrap" IsReadOnly="True" BorderThickness="0" Background="Transparent" 
                                 Foreground="{DynamicResource GlobalTextBrush}" MaxHeight="200" VerticalScrollBarVisibility="Auto"/>
                        
                        <TextBlock Text="{x:Static properties:Resources.Exception}" FontWeight="Bold" Margin="0,10,0,2"/>
                        <TextBox x:Name="DetailException" TextWrapping="Wrap" IsReadOnly="True" BorderThickness="0" Background="Transparent"
                                 Foreground="{DynamicResource GlobalTextBrush}" MaxHeight="200" VerticalScrollBarVisibility="Auto"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="3" Height="30" Background="{DynamicResource GlobalBackground}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
            <Grid Margin="5,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Total Records -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{x:Static properties:Resources.TotalRecords}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="TotalCountText" Text="0" Margin="0,0,20,0"/>
                    <TextBlock Text="{x:Static properties:Resources.PageSize}" Margin="0,0,5,0"/>
                    <ComboBox x:Name="PageSizeComboBox" Width="70" VerticalAlignment="Center" SelectionChanged="PageSizeComboBox_SelectionChanged">
                        <ComboBoxItem Content="50"/>
                        <ComboBoxItem Content="100" IsSelected="True"/>
                        <ComboBoxItem Content="200"/>
                        <ComboBoxItem Content="500"/>
                        <ComboBoxItem Content="1000"/>
                    </ComboBox>
                </StackPanel>
                
                <!-- Page Navigation -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="|&lt;" Click="FirstPage_Click" Width="30" Margin="2,0" ToolTip="{x:Static properties:Resources.FirstPage}"/>
                    <Button Content="&lt;" Click="PrevPage_Click" Width="30" Margin="2,0" ToolTip="{x:Static properties:Resources.PrevPage}"/>
                    <TextBlock Text="{x:Static properties:Resources.Page}" VerticalAlignment="Center" Margin="5,0,5,0"/>
                    <TextBox x:Name="CurrentPageTextBox" Text="1" Width="50" VerticalAlignment="Center" TextAlignment="Center" KeyDown="CurrentPageTextBox_KeyDown"/>
                    <TextBlock Text="/" VerticalAlignment="Center" Margin="5,0,5,0"/>
                    <TextBlock x:Name="TotalPagesText" Text="1" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Button Content="&gt;" Click="NextPage_Click" Width="30" Margin="2,0" ToolTip="{x:Static properties:Resources.NextPage}"/>
                    <Button Content="&gt;|" Click="LastPage_Click" Width="30" Margin="2,0" ToolTip="{x:Static properties:Resources.LastPage}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
