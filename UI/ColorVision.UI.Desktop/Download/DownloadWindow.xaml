<Window x:Class="ColorVision.UI.Desktop.Download.DownloadWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ColorVision.UI.Desktop.Download"
        xmlns:properties="clr-namespace:ColorVision.UI.Desktop.Properties"
        mc:Ignorable="d"
        Title="{x:Static properties:Resources.DownloadManager}" Height="600" Width="900"
        Background="{DynamicResource GlobalBackground}" Initialized="Window_Initialized">
    <Window.Resources>
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="{DynamicResource GlobalTextBrush}"/>
        </Style>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Grid Margin="5">
            <StackPanel Orientation="Horizontal" >
                <Button x:Name="BtnAddUrl" Content="{x:Static properties:Resources.AddDownload}" Click="BtnAddUrl_Click" Margin="2,0"/>
                <Separator Margin="5,0"/>
                <Button Content="{x:Static properties:Resources.ClearRecords}" Click="ClearRecords_Click" Margin="2,0"/>
                <Separator Margin="5,0"/>
                <TextBlock Text="{x:Static properties:Resources.Search}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox x:Name="SearchTextBox" Width="200" VerticalAlignment="Center" TextChanged="SearchTextBox_TextChanged"/>
                <Separator Margin="5,0"/>
                <Button Content="{x:Static properties:Resources.Refresh}" Click="Refresh_Click" Margin="2,0"/>
                <Separator Margin="5,0"/>
                <Button Content="{x:Static properties:Resources.DownloadSettings}" Click="Settings_Click" Margin="2,0"/>
            </StackPanel>
        </Grid>

        <!-- Download List -->
        <ListView x:Name="DownloadListView" Grid.Row="1" Margin="5,0,5,5"
                  SelectionMode="Extended"
                  MouseDoubleClick="DownloadListView_MouseDoubleClick">
            <ListView.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="{x:Static properties:Resources.OpenFile}" Click="ContextMenu_OpenFile_Click"/>
                    <MenuItem Header="{x:Static properties:Resources.OpenFolder}" Click="ContextMenu_OpenFolder_Click"/>
                    <Separator/>
                    <MenuItem Header="{x:Static properties:Resources.CopyUrl}" Click="ContextMenu_CopyUrl_Click"/>
                    <Separator/>
                    <MenuItem Header="{x:Static properties:Resources.PauseDownload}" Click="ContextMenu_Pause_Click"/>
                    <MenuItem Header="{x:Static properties:Resources.ResumeDownload}" Click="ContextMenu_Resume_Click"/>
                    <MenuItem Header="{x:Static properties:Resources.RetryDownload}" Click="ContextMenu_Retry_Click"/>
                    <MenuItem Header="{x:Static properties:Resources.CancelDownload}" Click="ContextMenu_Cancel_Click"/>
                    <Separator/>
                    <MenuItem Header="{x:Static properties:Resources.DeleteRecord}" Click="ContextMenu_Delete_Click"/>
                </ContextMenu>
            </ListView.ContextMenu>
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="{x:Static properties:Resources.FileName}" Width="250">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" MaxWidth="240">
                                    <TextBlock Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" FontSize="16" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding FileName}" TextWrapping="Wrap" MaxHeight="40" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="{x:Static properties:Resources.Progress}" Width="200">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Grid Width="180">
                                    <ProgressBar Value="{Binding ProgressValue}" Height="22" Minimum="0" Maximum="100"
                                                 Visibility="{Binding IsDownloading, Converter={StaticResource BoolToVisibility}}"/>
                                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="11"
                                               Visibility="{Binding IsDownloading, Converter={StaticResource BoolToVisibility}}">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}%">
                                                <Binding Path="ProgressValue"/>
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="{x:Static properties:Resources.StatusHeader}" Width="90" DisplayMemberBinding="{Binding StatusText}"/>
                    <GridViewColumn Header="{x:Static properties:Resources.Speed}" Width="100" DisplayMemberBinding="{Binding SpeedText}"/>
                    <GridViewColumn Header="{x:Static properties:Resources.FileSize}" Width="140" DisplayMemberBinding="{Binding FileSizeDisplayText}"/>
                    <GridViewColumn Header="{x:Static properties:Resources.CreateTimeHeader}" Width="140" DisplayMemberBinding="{Binding CreateTime, StringFormat=yyyy-MM-dd HH:mm:ss}"/>
                    <GridViewColumn Width="70">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="&#xE838;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                            Background="Transparent" BorderThickness="0" Cursor="Hand"
                                            ToolTip="{x:Static properties:Resources.OpenFolder}"
                                            Click="InlineOpenFolder_Click" Padding="4,2" Margin="0,0,2,0"/>
                                    <Button Content="&#xE74D;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                            Background="Transparent" BorderThickness="0" Cursor="Hand"
                                            ToolTip="{x:Static properties:Resources.DeleteRecord}"
                                            Click="InlineDelete_Click" Padding="4,2"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Status Bar -->
        <Border Grid.Row="2" Height="30" Background="{DynamicResource GlobalBackground}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
            <Grid Margin="5,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{x:Static properties:Resources.TotalRecords}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="TotalCountText" Text="0" Margin="0,0,20,0"/>
                    <TextBlock x:Name="StatusBarText" Text="" Margin="10,0,0,0" Foreground="Gray"/>
                    <TextBlock Text="{x:Static properties:Resources.PageSize}" Margin="20,0,5,0"/>
                    <ComboBox x:Name="PageSizeComboBox" Width="70" VerticalAlignment="Center" SelectionChanged="PageSizeComboBox_SelectionChanged">
                        <ComboBoxItem Content="20" IsSelected="True"/>
                        <ComboBoxItem Content="50"/>
                        <ComboBoxItem Content="100"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="|&lt;" Click="FirstPage_Click" Width="30" Margin="2,0"/>
                    <Button Content="&lt;" Click="PrevPage_Click" Width="30" Margin="2,0"/>
                    <TextBlock Text="{x:Static properties:Resources.Page}" VerticalAlignment="Center" Margin="5,0"/>
                    <TextBox x:Name="CurrentPageTextBox" Text="1" Width="50" VerticalAlignment="Center" TextAlignment="Center" KeyDown="CurrentPageTextBox_KeyDown"/>
                    <TextBlock Text="/" VerticalAlignment="Center" Margin="5,0"/>
                    <TextBlock x:Name="TotalPagesText" Text="1" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Button Content="&gt;" Click="NextPage_Click" Width="30" Margin="2,0"/>
                    <Button Content="&gt;|" Click="LastPage_Click" Width="30" Margin="2,0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
