<Window x:Class="ProjectStarkSemi.ConoscopeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:im="clr-namespace:ColorVision.ImageEditor;assembly=ColorVision.ImageEditor"
        xmlns:local="clr-namespace:ProjectStarkSemi"
        xmlns:Conoscope="clr-namespace:ProjectStarkSemi.Conoscope"
        xmlns:properties="clr-namespace:ProjectStarkSemi.Properties"
        xmlns:ScottPlot="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance  Conoscope:ConoscopeManager}"
        Title="Conoscope" Height="750" Width="1280" Background="{StaticResource GlobalBackground}" Initialized="Window_Initialized" Closed="Window_Closed">
    <Grid Margin="5,5,5,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Ribbon Background="Transparent">
                <Ribbon.Resources>
                    <RibbonGroupSizeDefinitionBaseCollection x:Key="4ControlLSC">
                        <RibbonGroupSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Large" IsLabelVisible="True" />
                            <RibbonControlSizeDefinition ImageSize="Large" IsLabelVisible="True" />
                            <RibbonControlSizeDefinition ImageSize="Large" IsLabelVisible="True" />
                            <RibbonControlSizeDefinition ImageSize="Large" IsLabelVisible="True" />
                        </RibbonGroupSizeDefinition>
                        <RibbonGroupSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                        </RibbonGroupSizeDefinition>
                        <RibbonGroupSizeDefinition IsCollapsed="True" />
                    </RibbonGroupSizeDefinitionBaseCollection>
                    <RibbonGroupSizeDefinitionBaseCollection x:Key="3ControlSC">
                        <RibbonGroupSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="True" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="True" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="True" />
                        </RibbonGroupSizeDefinition>
                        <RibbonGroupSizeDefinition IsCollapsed="True" />
                    </RibbonGroupSizeDefinitionBaseCollection>
                    <RibbonGroupSizeDefinitionBaseCollection x:Key="5ControlSC">
                        <RibbonGroupSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False" />
                        </RibbonGroupSizeDefinition>
                        <RibbonGroupSizeDefinition IsCollapsed="True" />
                    </RibbonGroupSizeDefinitionBaseCollection>
                </Ribbon.Resources>
                <!-- <snippetAppMenuItems> -->
                <Ribbon.ApplicationMenu>
                    <RibbonApplicationMenu SmallImageSource="Assets/Image/ColorVision1.ico" Background="Transparent"  KeyTip="F">
                        <RibbonApplicationMenuItem Header="Open"
                                                      ImageSource="Images/Open32.png"
                                                      KeyTip="O" Click="OpenFile_Click" />
                        <RibbonApplicationMenuItem Header="Save"
                                                      Command="Save"
                                                      ImageSource="Images/Save32.png"
                                                      KeyTip="S" />
                        <RibbonApplicationSplitMenuItem Header="Save As"
                                                           Command="SaveAs"
                                                           ImageSource="Images/SaveAs32.png" 
                                                           KeyTip="V" >
                            <RibbonApplicationMenuItem Header="Rich Text document"
                                                          Command="SaveAs" CommandParameter="rtf"
                                                          ImageSource="Images/SaveAsRtf32.png" 
                                                          KeyTip="R" />
                            <RibbonApplicationMenuItem Header="Plain Text document"
                                                          Command="SaveAs" CommandParameter="txt"
                                                          ImageSource="Images/SaveAsTxt32.png"
                                                          KeyTip="P" />
                            <RibbonApplicationMenuItem Header="Other format"
                                                          Command="SaveAs"
                                                          ImageSource="Images/SaveAs32.png" 
                                                          KeyTip="O" />
                        </RibbonApplicationSplitMenuItem>
                        <RibbonSeparator />
                        <RibbonApplicationSplitMenuItem Header="Print" 
                                                           ImageSource="Images/Print32.png"
                                                           KeyTip="R">
                            <RibbonApplicationMenuItem Header="Print"
                                                          ImageSource="Images/Print32.png"
                                                          KeyTip="P" />
                            <RibbonApplicationMenuItem Header="Quick Print"
                                                          ImageSource="Images/QuickPrint32.png"
                                                          KeyTip="Q" />
                            <RibbonApplicationMenuItem Header="Print Preview"
                                                          ImageSource="Images/PrintPreview32.png"
                                                          KeyTip="V" />
                        </RibbonApplicationSplitMenuItem>
                        <RibbonApplicationMenuItem Header="Page Setup"
                                                      ImageSource="Images/PrintSetup32.png"
                                                      KeyTip="G" />
                        <!-- </snippetAppMenuItems> -->
                        <!-- <snippetAppMenuFooter> -->
                        <RibbonApplicationMenu.FooterPaneContent>
                            <DockPanel LastChildFill="False">
                                <RibbonButton Command="ApplicationCommands.Close"
                                                 Label="Exit"
                                                 ToolTipTitle="Exit" 
                                                 SmallImageSource="Images\Exit16.png"
                                                 KeyTip="X"
                                                 DockPanel.Dock="Right"
                                                 Margin="2"
                                                 BorderBrush="#B8114EAF" />
                            </DockPanel>
                        </RibbonApplicationMenu.FooterPaneContent>
                        <!-- </snippetAppMenuFooter> -->
                        <!-- <snippetAppMenuAuxPane> -->
                        <RibbonApplicationMenu.AuxiliaryPaneContent>
                            <RibbonGallery CanUserFilter="False"
                                              ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <RibbonGalleryCategory Header="Recent Documents" 
                                                          Background="Transparent" 
                                                          ItemsSource="{DynamicResource MostRecentFiles}">
                                    <RibbonGalleryCategory.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Vertical" IsItemsHost="True"/>
                                        </ItemsPanelTemplate>
                                    </RibbonGalleryCategory.ItemsPanel>
                                </RibbonGalleryCategory>
                            </RibbonGallery>
                        </RibbonApplicationMenu.AuxiliaryPaneContent>
                        <!-- </snippetAppMenuAuxPane> -->
                    </RibbonApplicationMenu>
                </Ribbon.ApplicationMenu>
                <Ribbon.QuickAccessToolBar>
                    <RibbonQuickAccessToolBar >
                        <RibbonButton Command="Save"   
                                         SmallImageSource="Images/Save16.png"
                                         KeyTip="1"/>
                        <RibbonButton Command="Undo"   
                                         SmallImageSource="Images/ArrowUndo16.png"
                                         KeyTip="2" />
                        <RibbonButton Command="Redo"  
                                         SmallImageSource="Images/ArrowRedo16.png"
                                         KeyTip="3"/>
                        
                    </RibbonQuickAccessToolBar>
                </Ribbon.QuickAccessToolBar>

                <RibbonTab Header="Home"  KeyTip="H"  GroupSizeReductionOrder="Clipboard, Insert, Insert, Paragraph, Clipboard, Editing, Font, Clipboard" >
                    <RibbonGroup Header="Files">
                        <RibbonButton Label="Open" SmallImageSource="Images/Open32.png"  KeyTip="O" Click="OpenFile_Click" />
                        <RibbonButton Label="SaveAs" SmallImageSource="Images/SaveAs32.png"  KeyTip="O" Click="OpenFile_Click" />
                        <RibbonButton Label="导出CSV"  Click="btnExportCSV_Click" Padding="10,5"/>
                    </RibbonGroup>
                </RibbonTab>
                <RibbonTab Header="Camera"  Padding="10">
                    <RibbonGroup x:Name="rbnGr2" Header="General">
                        <StackPanel>
                            <DockPanel >
                                <TextBlock Text="{x:Static properties:Resources.Model}" VerticalAlignment="Center" Width="80"/>
                                <ComboBox x:Name="cbModelType"  SelectionChanged="cbModelType_SelectionChanged" SelectedItem="{Binding ConoscopeConfig.CurrentModel}">
                                </ComboBox>
                            </DockPanel>
                        </StackPanel>
                        <Button x:Name="btnOpenObservationCamera" 
                        Content="{x:Static properties:Resources.OpenObservationCamera}"
                        Click="btnOpenObservationCamera_Click"
                        Height="30"/>
                    </RibbonGroup>


                    <RibbonGroup  Header="General" >
                        <DockPanel Margin="0,0,0,10">
                            <ComboBox x:Name="cbMeasurementCamera"  SelectionChanged="cbMeasurementCamera_SelectionChanged"/>
                        </DockPanel>
                        <DockPanel Margin="0,0,0,10">
                            <Grid Width="20" Margin="5,0" DockPanel.Dock="Right" HorizontalAlignment="Left">
                                <TextBlock Text="&#xE713;"  HorizontalAlignment="Center" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="{DynamicResource GlobalTextBrush}">
                                    <TextBlock.RenderTransform>
                                        <RotateTransform x:Name="rotateTransform4" CenterX="8" CenterY="8"/>
                                    </TextBlock.RenderTransform>
                                </TextBlock>
                                <Button  Width="20" BorderBrush="Transparent" Background="Transparent" BorderThickness="0"  Click="MenuItem_Template">
                                    <Button.Triggers>
                                        <EventTrigger RoutedEvent="Button.Click">
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="rotateTransform4" Storyboard.TargetProperty="Angle" From="0" To="360" Duration="0:0:0.5" FillBehavior="Stop"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Button.Triggers>
                                </Button>
                            </Grid>
                            <ComboBox x:Name="ComboxCalibrationTemplate"  SelectedIndex="{Binding CalibrationTemplateIndex}"  SelectedValuePath="Value" DisplayMemberPath="Key"/>
                        </DockPanel>

                        <Button x:Name="btnOpenMeasurementCamera" 
                              Content="{x:Static properties:Resources.CaptureImage}"
                              Click="btnOpenMeasurementCamera_Click"
                              Margin="0,0,0,5"
                              Height="30"/>

                        <Button x:Name="btnCalibration" 
                              Content="{x:Static properties:Resources.Calibration}"
                              Click="btnCalibration_Click"
                              Height="30"/>
                    </RibbonGroup>
                    <RibbonGroup Header="{x:Static properties:Resources.ImageFilter}">
                        <StackPanel >
                            <DockPanel Margin="0,0,0,10">
                                <TextBlock Text="{x:Static properties:Resources.FilterType}" VerticalAlignment="Center" Width="80"/>
                                <ComboBox x:Name="cbFilterType" 
                                      SelectionChanged="cbFilterType_SelectionChanged"
                                      SelectedIndex="0">
                                    <ComboBoxItem Content="{x:Static properties:Resources.NoFilter}"/>
                                    <ComboBoxItem Content="{x:Static properties:Resources.LowPassFilter}"/>
                                    <ComboBoxItem Content="{x:Static properties:Resources.MovingAverage}"/>
                                    <ComboBoxItem Content="{x:Static properties:Resources.GaussianFilter}"/>
                                    <ComboBoxItem Content="{x:Static properties:Resources.MedianFilter}"/>
                                    <ComboBoxItem Content="{x:Static properties:Resources.BilateralFilter}"/>
                                </ComboBox>
                            </DockPanel>


                        </StackPanel>

                        <!-- Kernel Size Parameter -->
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="{x:Static properties:Resources.KernelSize}" VerticalAlignment="Center" Width="80"/>
                            <TextBlock Text="{Binding ElementName=sliderKernelSize, Path=Value}" 
                                       Width="30" TextAlignment="Right" VerticalAlignment="Center"/>
                            <Slider x:Name="sliderKernelSize" 
                                    Minimum="1" Maximum="31" Value="5" 
                                    TickFrequency="2" IsSnapToTickEnabled="True"
                                    Margin="5,0,0,0"/>
                        </DockPanel>

                        <!-- Sigma Parameter (for Gaussian) -->
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="σ (Sigma)" VerticalAlignment="Center" Width="80"/>
                            <TextBlock Text="{Binding ElementName=sliderSigma, Path=Value, StringFormat=F1}" 
                                       Width="30" TextAlignment="Right" VerticalAlignment="Center"/>
                            <Slider x:Name="sliderSigma" 
                                    Minimum="0.1" Maximum="10" Value="1.0" 
                                    TickFrequency="0.1" IsSnapToTickEnabled="True"
                                    Margin="5,0,0,0" IsEnabled="False"/>
                        </DockPanel>

                        <!-- D Parameter (for Bilateral) -->
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="d" VerticalAlignment="Center" Width="80"/>
                            <TextBlock Text="{Binding ElementName=sliderD, Path=Value}" 
                                       Width="30" TextAlignment="Right" VerticalAlignment="Center"/>
                            <Slider x:Name="sliderD" 
                                    Minimum="1" Maximum="15" Value="5" 
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    Margin="5,0,0,0" IsEnabled="False"/>
                        </DockPanel>

                        <!-- Sigma Color Parameter (for Bilateral) -->
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="σColor" VerticalAlignment="Center" Width="80"/>
                            <TextBlock Text="{Binding ElementName=sliderSigmaColor, Path=Value, StringFormat=F0}" 
                                       Width="30" TextAlignment="Right" VerticalAlignment="Center"/>
                            <Slider x:Name="sliderSigmaColor" 
                                    Minimum="1" Maximum="200" Value="75" 
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    Margin="5,0,0,0" IsEnabled="False"/>
                        </DockPanel>

                        <!-- Sigma Space Parameter (for Bilateral) -->
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="σSpace" VerticalAlignment="Center" Width="80"/>
                            <TextBlock Text="{Binding ElementName=sliderSigmaSpace, Path=Value, StringFormat=F0}" 
                                       Width="30" TextAlignment="Right" VerticalAlignment="Center"/>
                            <Slider x:Name="sliderSigmaSpace" 
                                    Minimum="1" Maximum="200" Value="75" 
                                    TickFrequency="1" IsSnapToTickEnabled="True"
                                    Margin="5,0,0,0" IsEnabled="False"/>
                        </DockPanel>

                        <Button x:Name="btnApplyFilter" 
                                Content="{x:Static properties:Resources.ApplyFilter}"
                                Click="btnApplyFilter_Click"
                                />
                    </RibbonGroup>


                </RibbonTab>

                <RibbonTab Header="Edit">

                </RibbonTab>

                <RibbonTab Header="View">

                </RibbonTab>

                <RibbonTab Header="Analysis">
                    <RibbonGroup Header="Grey Levels">
                        <RibbonButton  Content="NEw Data Set"/>
                        <RibbonButton  Content="Open"/>
                        <RibbonButton  Content="HideAll"/>
                        <RibbonButton  Content="VT Curve"/>
                    </RibbonGroup>
                    <RibbonGroup Header="Display Aspect">
                        <RibbonButton  Content="NEw Data Set"/>
                        <RibbonButton  Content="Open"/>
                    </RibbonGroup>
                    <RibbonGroup Header="3D Displays">
                        <RibbonButton  Content="NEw Data Set"/>
                        <RibbonButton  Content="Open"/>
                    </RibbonGroup>
                </RibbonTab>


                <RibbonTab Header="Help">
                    <RibbonGroup Header="Help" x:Name="Help"  SmallImageSource="Images/InsertPicture16.png" GroupSizeDefinitions="{DynamicResource 4ControlLSC}">
                    </RibbonGroup>

                    <RibbonGroup Header="About" x:Name="About"  SmallImageSource="Images/InsertPicture16.png" GroupSizeDefinitions="{DynamicResource 4ControlLSC}">
                        <RibbonButton SmallImageSource="Images/smallicon.png"  Click="RibbonButton_Click"/>
                    </RibbonGroup>

                </RibbonTab>
            </Ribbon>
            <Button  VerticalAlignment="Top" HorizontalAlignment="Right" Command="{Binding EditConoscopeConfigCommand}" Padding="2" Height="40" Width="40" >
                <Button.Triggers>
                    <EventTrigger RoutedEvent="Button.Click">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="rotateTransform2" Storyboard.TargetProperty="Angle" From="0" To="360" Duration="0:0:0.5" FillBehavior="Stop"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Button.Triggers>
                <TextBlock Text="&#xE713;"  HorizontalAlignment="Center" FontFamily="Segoe MDL2 Assets" FontSize="25" Foreground="{DynamicResource GlobalTextBrush}">
                    <TextBlock.RenderTransform>
                        <RotateTransform x:Name="rotateTransform2" CenterX="8" CenterY="8"/>
                    </TextBlock.RenderTransform>
                </TextBlock>
            </Button>
        </Grid>

        <!-- Main Content Area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Side: Image Display -->
            <Grid Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="640"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <im:ImageView x:Name="ImageView" Grid.Column="0"/>
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <ScottPlot:WpfPlot Grid.Row="1" x:Name="wpfPlot"/>
                    <StackPanel Grid.Row="0" Orientation="Vertical" Margin="5">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox x:Name="chkShowRed" 
                                          Content="R" 
                                          Foreground="Red" 
                                          IsChecked="{Binding Config.IsShowRedChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                            <CheckBox x:Name="chkShowGreen" 
                                          Content="G" 
                                          Foreground="Green" 
                                          IsChecked="{Binding Config.IsShowGreenChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                            <CheckBox x:Name="chkShowBlue" 
                                          Content="B" 
                                          Foreground="Blue" 
                                          IsChecked="{Binding Config.IsShowBlueChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                            <CheckBox x:Name="chkShowXlue" 
                                          Content="X" 
                                          Foreground="Gold" 
                                          IsChecked="{Binding Config.IsShowXChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                            <CheckBox x:Name="chkShowYlue" 
                                          Content="Y" 
                                          Foreground="Gray" 
                                          IsChecked="{Binding Config.IsShowYChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                            <CheckBox x:Name="chkShowZlue" 
                                          Content="Z" 
                                          Foreground="Violet" 
                                          IsChecked="{Binding Config.IsShowZChannel}"
                                          Margin="5,0"
                                          Checked="RgbChannelVisibility_Changed"
                                          Unchecked="RgbChannelVisibility_Changed"/>
                        </StackPanel>

                        <GroupBox Header="角度管理" Margin="0,0,0,5">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <TextBlock Text="添加角度:" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    <TextBox x:Name="txtAngle" 
                                             MinWidth="60" 
                                             VerticalAlignment="Center"
                                             Margin="0,0,5,0"/>
                                    <TextBlock Text="°" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                    <Button Content="添加" 
                                            Click="btnAddAngle_Click"
                                            Padding="10,2"
                                            Margin="0,0,5,0"/>
                                    <Button Content="删除选中" 
                                            Click="btnRemoveAngle_Click"
                                            Padding="10,2"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="当前角度:" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    <ComboBox x:Name="cbPolarAngleLines" 
                                              MinWidth="100" 
                                              SelectionChanged="cbPolarAngleLines_SelectionChanged"/>
                                    <Button Content="导出CSV"  Click="btnExportCSV_Click" Padding="10,5"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <!-- Export Settings -->
                        <GroupBox Header="导出设置" Margin="0,0,0,5">
                            <StackPanel Orientation="Horizontal">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <TextBlock Text="导出模式:" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    <ComboBox x:Name="cbExportMode" 
                                              MinWidth="120" 
                                              SelectedIndex="0">
                                        <ComboBoxItem Content="按角度导出" Tag="Angle"/>
                                        <ComboBoxItem Content="按同心圆导出" Tag="Circle"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <TextBlock Text="导出通道:" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    <ComboBox x:Name="cbExportChannel" MinWidth="120" SelectedIndex="4">
                                        <ComboBoxItem Content="R通道" Tag="R"/>
                                        <ComboBoxItem Content="G通道" Tag="G"/>
                                        <ComboBoxItem Content="B通道" Tag="B"/>
                                        <ComboBoxItem Content="X通道" Tag="X"/>
                                        <ComboBoxItem Content="Y通道" Tag="Y"/>
                                        <ComboBoxItem Content="Z通道" Tag="Z"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="角度模式导出"   Click="btnExportAngleMode_Click"    Padding="10,5"  Margin="5,0,5,0"/>
                                    <Button Content="同心圆模式导出"    Click="btnExportCircleMode_Click"   Padding="10,5"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                    </StackPanel>
                </Grid>
            </Grid>

        </Grid>

        <!-- Status Bar at Bottom -->
        <StatusBar Grid.Row="2" Height="25">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            
            <StatusBarItem Grid.Column="0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{x:Static properties:Resources.CurrentModel}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="tbCurrentModel" Text="VA60" FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
            
            <Separator Grid.Column="1" />
            
            <StatusBarItem Grid.Column="2">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{x:Static properties:Resources.MeasurementCameraStatus}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="tbMeasurementCameraStatus" Text="{x:Static properties:Resources.NotOpened}" Foreground="Gray"/>
                </StackPanel>
            </StatusBarItem>
            
            <Separator Grid.Column="3" x:Name="ObservationCameraSeparator"/>
            
            <StatusBarItem Grid.Column="4" x:Name="ObservationCameraStatusItem">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{x:Static properties:Resources.ObservationCameraStatus}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="tbObservationCameraStatus" Text="{x:Static properties:Resources.NotOpened}" Foreground="Gray"/>
                    <TextBlock Text=" | " Margin="10,0,5,0"/>
                    <TextBlock Text="{x:Static properties:Resources.CalibrationStatus}" Margin="0,0,5,0"/>
                    <TextBlock x:Name="tbCalibrationStatus" Text="{x:Static properties:Resources.NotCalibrated}" Foreground="Orange"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
