# ProjectARVRPro 快速入门教程

## 目录

1. [准备工作](#准备工作)
2. [第一次运行](#第一次运行)
3. [配置测试流程](#配置测试流程)
4. [执行测试](#执行测试)
5. [查看和导出结果](#查看和导出结果)
6. [进阶配置](#进阶配置)

---

## 准备工作

### 系统要求

- **操作系统**: Windows 10/11 (64位)
- **运行时**: .NET 8.0 Runtime
- **硬件**: 
  - CPU: Intel i5或以上
  - 内存: 8GB以上
  - 存储: 至少10GB可用空间

### 设备准备

确保以下设备已正确连接和配置：
1. AR/VR测试设备
2. 图像采集相机
3. 图案生成器（PG）
4. 其他必要的测试设备

### 网络配置

- 确保MQTT服务正在运行（默认端口：1883）
- 检查设备网络连接
- 验证防火墙设置允许通信

---

## 第一次运行

### 1. 启动应用程序

双击运行 `ProjectARVRPro.exe` 或从主程序菜单启动：

```
主程序 → 项目 → ProjectARVRPro
```

### 2. 主界面介绍

启动后您将看到主窗口（ARVRWindow），包含以下主要区域：

```
┌─────────────────────────────────────┐
│  菜单栏                             │
├─────────────────────────────────────┤
│  工具栏                             │
├──────────┬──────────────────────────┤
│          │                          │
│  流程    │    测试区域              │
│  进度    │                          │
│  显示    │                          │
│          │                          │
├──────────┴──────────────────────────┤
│  状态栏                             │
└─────────────────────────────────────┘
```

**主要功能区**：
- **菜单栏**: 访问所有功能和设置
- **工具栏**: 快速访问常用功能
- **流程进度**: 显示当前测试进度（StepBar）
- **测试区域**: 显示测试结果和图像
- **状态栏**: 显示当前状态和消息

### 3. 检查设备连接

在开始测试前，检查设备连接状态：

1. 点击菜单：`设备 → 设备管理`
2. 检查所有设备状态为"已连接"
3. 如有设备未连接，点击"连接"按钮

---

## 配置测试流程

### 方法1: 使用默认配置（推荐新手）

系统首次运行会自动加载默认配置，包含常用测试步骤。您可以直接跳到[执行测试](#执行测试)。

### 方法2: 自定义配置

#### 打开流程管理器

点击工具栏的"流程管理"按钮，或通过菜单：
```
工具 → 流程管理
```

#### 添加测试步骤

在ProcessManagerWindow中：

1. **输入步骤名称**
   ```
   名称: White255测试
   ```

2. **选择流程模板**
   - 从下拉列表选择对应的流程模板
   - 例如：`White255Flow`

3. **选择Process类型**
   - 从下拉列表选择对应的Process
   - 例如：`White255Process`

4. **点击"添加"按钮**

5. **重复以上步骤添加更多测试**

#### 常用测试步骤配置示例

```
1. White255测试
   - 模板: White255Flow
   - Process: White255Process
   
2. Black测试
   - 模板: BlackFlow
   - Process: BlackProcess
   
3. Distortion测试
   - 模板: DistortionFlow
   - Process: DistortionProcess
   
4. MTF测试
   - 模板: MTFHVFlow
   - Process: MTFHVProcess
```

#### 调整执行顺序

使用"上移"/"下移"按钮调整测试步骤的执行顺序：

1. 选中要移动的步骤
2. 点击"上移"或"下移"
3. 推荐顺序：快速测试 → 复杂测试

#### 启用/禁用步骤

通过"是否启用"复选框控制步骤：

- ✅ 勾选：该步骤将被执行
- ☐ 不勾选：该步骤将被跳过

**使用场景**：
- 快速测试：只启用关键步骤
- 调试：只启用需要调试的步骤
- 完整测试：启用所有步骤

#### 保存配置

配置会自动保存，无需手动操作。关闭窗口即完成配置。

---

## 执行测试

### 自动测试流程

#### 1. 准备测试

1. 确认设备连接正常
2. 检查测试流程配置
3. 确认测试环境符合要求

#### 2. 启动测试

点击"开始测试"按钮，或通过菜单：
```
测试 → 开始测试
```

#### 3. 测试执行过程

系统将按照配置的顺序执行测试：

```
初始化 → 步骤1 → 步骤2 → ... → 步骤N → 完成
```

**执行过程中**：
- StepBar显示当前进度
- 状态栏显示当前步骤
- 测试区域显示实时结果
- 禁用的步骤自动跳过

#### 4. 监控测试

**查看日志**：
```
窗口 → 日志查看器
```

**实时进度**：
- 绿色：已完成
- 蓝色：进行中
- 灰色：待执行
- 红色：失败

#### 5. 测试完成

测试完成后：
- 系统自动保存结果
- 显示测试汇总信息
- 可以查看详细结果

### 手动测试（单步执行）

如需单独执行某个测试步骤：

1. 在流程管理器中选择步骤
2. 点击"执行选中步骤"
3. 查看单步测试结果

---

## 查看和导出结果

### 查看测试结果

#### 方法1: 测试结果窗口

测试完成后自动打开，或手动打开：
```
查看 → 测试结果
```

**结果窗口包含**：
- 测试汇总数据
- 各步骤详细结果
- 测试图像
- 统计图表

#### 方法2: 历史记录查询

查看历史测试记录：

1. 打开结果窗口
2. 选择日期范围
3. 点击"查询"
4. 选择要查看的记录

### 导出结果

#### 导出CSV

1. 在结果窗口点击"导出"
2. 选择"导出为CSV"
3. 选择保存位置
4. 输入文件名
5. 点击"保存"

**CSV文件包含**：
- 测试参数
- 测试数据
- 统计信息
- 时间戳

#### 导出PDF报告

1. 在结果窗口点击"导出"
2. 选择"导出为PDF"
3. 选择保存位置
4. 输入文件名
5. 点击"保存"

**PDF报告包含**：
- 测试概要
- 详细数据表
- 图表和图像
- 结论和建议

#### 批量导出

导出多个测试记录：

1. 在历史记录中勾选要导出的记录
2. 点击"批量导出"
3. 选择导出格式（CSV/PDF）
4. 选择保存文件夹
5. 点击"确定"

---

## 进阶配置

### Recipe配置

Recipe控制测试的具体参数，如ROI区域、阈值等。

#### 编辑Recipe

1. 在流程管理器中选择步骤
2. 点击"编辑Recipe"按钮
3. 在属性编辑器中修改参数
4. 点击"确定"保存

#### 常用Recipe参数

**ROI配置**：
```
ROI X: 0          # 起始X坐标
ROI Y: 0          # 起始Y坐标
ROI宽度: 1920     # ROI宽度
ROI高度: 1080     # ROI高度
```

**算法参数**：
```
Gamma: 0.45       # Gamma校正值
采样率: 0.5       # 采样密度(0.1-1.0)
阈值: 0.1         # 检测阈值
```

### Fix配置

Fix配置用于结果修正和补偿。

#### 编辑Fix配置

1. 在流程管理器中选择步骤
2. 点击"编辑Fix"按钮
3. 修改修正参数
4. 点击"确定"

### Process配置

Process配置控制测试流程的特定行为。

#### 编辑Process配置

1. 在流程管理器中选择步骤
2. 点击"编辑Process配置"按钮
3. 修改参数
4. 点击"确定"

### 创建配置预设

保存常用配置组合：

#### 方法1: 手动备份

1. 找到配置文件：
   ```
   %AppData%\ColorVision\ProjectARVRPro\ProcessMetas.json
   ```
2. 复制到安全位置
3. 重命名为有意义的名称，如：
   ```
   ProcessMetas_QuickTest.json
   ProcessMetas_FullTest.json
   ```

#### 方法2: 导出配置

1. 在流程管理器中点击"导出配置"
2. 选择保存位置
3. 输入配置名称
4. 点击"保存"

#### 恢复配置

1. 在流程管理器中点击"导入配置"
2. 选择配置文件
3. 点击"打开"
4. 确认替换当前配置

---

## 实战示例

### 示例1: 快速验证测试

**目标**：快速验证设备基本功能

**配置**：
```
步骤1: White255测试 (启用)
步骤2: Black测试 (启用)
其他步骤: (禁用)
```

**执行时间**：约2-3分钟

**适用场景**：
- 日常验证
- 快速故障排查
- 设备首次上线检查

### 示例2: 完整性能测试

**目标**：全面评估设备性能

**配置**：
```
步骤1: White255测试 (启用)
步骤2: Black测试 (启用)
步骤3: Chessboard测试 (启用)
步骤4: Distortion测试 (启用)
步骤5: MTF测试 (启用)
步骤6: OpticCenter测试 (启用)
步骤7: RGB测试 (启用)
```

**执行时间**：约15-20分钟

**适用场景**：
- 出厂检测
- 定期校准
- 完整性能评估

### 示例3: 光学性能测试

**目标**：专注于光学性能指标

**配置**：
```
步骤1: MTF测试 (启用)
步骤2: Distortion测试 (启用)
步骤3: OpticCenter测试 (启用)
其他步骤: (禁用)
```

**执行时间**：约8-10分钟

**适用场景**：
- 光学系统调试
- 镜头质量评估
- 畸变校正验证

---

## 常见操作技巧

### 快捷键

- `Ctrl+S`: 保存配置
- `F5`: 刷新结果
- `Ctrl+E`: 导出结果
- `Ctrl+Q`: 退出程序

### 提高测试效率

1. **合理使用IsEnabled**
   - 调试时只启用相关步骤
   - 产线测试只启用必要步骤

2. **优化ROI区域**
   - 尽量缩小ROI范围
   - 只包含关键检测区域

3. **调整采样率**
   - 快速测试：0.25-0.5
   - 精确测试：0.7-1.0

4. **并行准备**
   - 测试进行时准备下一批设备
   - 利用等待时间整理结果

### 故障快速定位

1. **查看日志**
   - 打开日志查看器
   - 搜索"Error"或"Exception"
   - 记录错误信息

2. **检查设备连接**
   - 验证网络连接
   - 检查MQTT服务
   - 确认设备电源

3. **验证配置**
   - 检查ProcessMetas配置
   - 验证Recipe参数
   - 确认设备配置

---

## 下一步

完成本教程后，您可以：

1. **深入学习**
   - 阅读[README.md](README.md)了解详细功能
   - 查看[性能优化指南](PERFORMANCE_OPTIMIZATION.md)
   - 学习[IsEnabled特性详解](Process/README_IsEnabled_Feature_CN.md)

2. **进阶配置**
   - 创建自定义Process
   - 开发专用算法模板
   - 集成外部设备

3. **获取帮助**
   - 查看[常见问题](README.md#常见问题)
   - 联系技术支持
   - 参考项目文档

---

## 附录

### 配置文件位置

```
主配置目录: %AppData%\ColorVision\ProjectARVRPro\

关键文件：
- ProcessMetas.json    # 流程配置
- RecipeConfig.json    # Recipe配置
- FixConfig.json       # Fix配置
- Settings.json        # 系统设置
```

### 默认参数参考

**White255测试默认参数**：
```json
{
  "RoiX": 0,
  "RoiY": 0,
  "RoiWidth": 1920,
  "RoiHeight": 1080,
  "Gamma": 0.45
}
```

**MTF测试默认参数**：
```json
{
  "RoiX": 100,
  "RoiY": 100,
  "RoiWidth": 500,
  "RoiHeight": 500,
  "Gamma": 0.01
}
```

### 联系方式

- **项目主页**: https://github.com/xincheng213618/scgd_general_wpf
- **在线文档**: https://xincheng213618.github.io/scgd_general_wpf/
- **技术支持**: support@colorvision.com

---

*本教程最后更新：2025年12月*
