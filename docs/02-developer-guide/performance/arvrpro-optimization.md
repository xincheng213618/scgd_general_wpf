# ProjectARVRPro 优化路线

面向 AR/VR Pro 版本的性能与体验优化计划，聚焦启动、流程执行与结果呈现的关键路径，便于规划近期迭代。

## 🎯 目标与衡量

- **启动耗时**：插件加载到可交互 < 8s（冷启动）；
- **流程切换延迟**：`SwitchPG`（切图/Pattern Generator 切换指令）到图案稳定 < 1s，跨流程跳步无卡顿；
- **结果生成**：单步骤结果生成与保存 < 3s（含截图/CSV/PDF）；
- **回放/查询**：历史结果列表加载 < 2s。

## 🔑 优先方向

1. **流程编排与跳步**  
   - 复用 `ProcessMeta.IsEnabled`，在 FlowInit 阶段一次性计算启用序列，减少逐步搜索。
   - 为切换后的下一步预取配方与模板，降低重读 IO。

2. **算法与图像链路**  
   - 统一图像缓存/复用策略，避免在同一流程内重复加载相同素材。
   - 对高频算法节点（MTF、畸变）开启批量处理或 GPU 优化（如可行）。

3. **数据读写与导出**  
   - 将结果写入切换为批量写（或合并事务），减少频繁 I/O。
   - CSV/PDF 导出使用 UTF-8 编码，复用现有表格模板与 `ReportGenerator`/`ObjectiveTestResult` 实现（位置：Engine/ColorVision.Engine/Reports 与 Projects/ProjectARVRPro）。
   - 通过统一编码与模板复用，确保含中文/符号的数据导出不乱码并减少重复维护工作。

4. **UI 与可视化**  
   - Result 视图使用虚拟化/分页加载，避免一次性绑定大量记录。
   - 在长耗时步骤显示进度/状态，避免无反馈。

## 🛠️ 近期落地清单

- [ ] 在 `ProcessManager` 生成的 `ProcessMetas.json` 中预存启用步骤序列，FlowInit 直接读取（完成标志：首个可用步骤定位耗时 < 1s，日志无逐步扫描）。  
- [ ] 为常用模板（Distortion/MTFHV/OpticCenter）添加启动时的轻量校验，失败则快速提示（完成标志：异常模板 2s 内提示且不阻塞其他流程）。  
- [ ] 为结果导出统一入口增加批量写入/延迟写开关（默认开启）（完成标志：单流程导出 I/O 归并为 1 次批量写）。  
- [ ] 在 `TestResultViewWindow`（Projects/ProjectARVRPro/TestResultViewWindow.xaml）结果列表启用数据虚拟化或分页（完成标志：500+ 记录滚动无明显卡顿）。  
- [ ] 增加关键路径的性能日志（启动、切图、算法耗时、导出），用于后续基线对比（完成标志：日志含耗时区段并可复现）。  

> 注：以上为执行路线，落地时应在 Windows x64 环境下验证，避免对现有流程行为产生回归。
