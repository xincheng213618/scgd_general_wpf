# 源测量单元 (SMU) 服务


针对文档目标“介绍 SMU 服务的功能，如何配置 SMU 进行电压/电流的源和测量操作，例如IV扫描。说明相关参数和数据处理。”，我优先分析了两个关键代码文件：

1. DeviceSMU.cs
- 该文件定义了 DeviceSMU 类，是 SMU 设备服务的核心类。
- 它继承自通用设备服务基类 DeviceService<ConfigSMU>，封装了 SMU 的配置、视图和 MQTT 服务。
- 通过构造函数初始化 MQTT 服务（MQTTSMU）和视图（ViewSMU），并提供编辑命令。
- 提供获取设备信息视图、显示控件和 MQTT 服务的重写方法。
- 体现了 MVVM 模式和命令模式的使用，界面和业务逻辑分离。

2. MQTTSMU.cs
- 该文件定义了 MQTTSMU 类，继承自 MQTTDeviceService<ConfigSMU>，实现了基于 MQTT 通信的 SMU 设备控制与数据交互。
- 订阅和监听指定主题消息，处理包括初始化、设置参数、打开设备、获取数据、扫描、关闭设备等事件。
- 提供了设置参数、打开设备、获取测量数据、扫描（IV扫描）、关闭输出等方法，封装了具体的 MQTT 消息发送逻辑。
- 通过事件机制将扫描结果和测量结果传递给调用者，支持异步消息处理。

这两个类是实现 SMU 功能的核心，DeviceSMU 负责整体管理和界面交互，MQTTSMU 负责底层 MQTT 通信和命令执行。结合它们可以较全面地描述 SMU 的功能、配置和数据处理流程。

接下来文档中将重点介绍这两个文件的结构和功能，结合代码示例和流程图，帮助用户理解如何通过配置实现电压/电流的源测量和扫描操作。
