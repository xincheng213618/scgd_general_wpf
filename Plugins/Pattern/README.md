# Pattern Plugin (å›¾å¡ç”Ÿæˆå·¥å…·)

[![Version](https://img.shields.io/badge/version-1.0-blue.svg)](manifest.json)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](../../docs/license.md)
[![ColorVision](https://img.shields.io/badge/ColorVision-Plugin-orange.svg)](../../README.md)

Pattern Pluginï¼ˆå›¾å¡ç”Ÿæˆå·¥å…·ï¼‰æ˜¯ ColorVision çš„ç»¼åˆæµ‹è¯•å›¾æ¡ˆç”Ÿæˆæ’ä»¶ï¼Œä¸ºæ˜¾ç¤ºå™¨æ ¡å‡†ã€æµ‹é‡å’Œè´¨é‡è¯„ä¼°æä¾›å¤šç§ç±»å‹çš„æµ‹è¯•å›¾æ¡ˆã€‚

## ğŸ¯ æ¦‚è¿°

Pattern Plugin ç”Ÿæˆå„ç§ç±»å‹çš„æµ‹è¯•å›¾æ¡ˆï¼Œè¿™äº›å›¾æ¡ˆå¯¹äºæ˜¾ç¤ºå™¨æµ‹è¯•ã€ç›¸æœºæ ¡å‡†å’Œå…‰å­¦æµ‹é‡ç³»ç»Ÿè‡³å…³é‡è¦ã€‚æ”¯æŒè‡ªå®šä¹‰åˆ†è¾¨ç‡ã€å‚æ•°æ¨¡æ¿ã€å…¨å±€å¯¼å…¥/å¯¼å‡ºã€å®æ—¶é¢„è§ˆä»¥åŠè‡ªå®šä¹‰è§†åœºé…ç½®ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- **11ç§å›¾æ¡ˆç±»å‹**ï¼šå…¨é¢çš„æµ‹è¯•å›¾æ¡ˆé›†åˆ
- **è‡ªå®šä¹‰åˆ†è¾¨ç‡**ï¼šæ”¯æŒæœ€é«˜8Kçš„ä»»æ„åˆ†è¾¨ç‡
- **æ¨¡æ¿ç³»ç»Ÿ**ï¼šä¿å­˜ã€åŠ è½½å’Œå…±äº«å›¾æ¡ˆé…ç½®
- **å®æ—¶é¢„è§ˆ**ï¼šå³æ—¶å›¾æ¡ˆå¯è§†åŒ–
- **è§†åœºæ§åˆ¶**ï¼šå¯è‡ªå®šä¹‰å›¾æ¡ˆå®šä½å’Œå¤§å°
- **æ‰¹é‡ç”Ÿæˆ**ï¼šä¸€æ¬¡ç”Ÿæˆå¤šä¸ªå›¾æ¡ˆ
- **å¯¼å‡ºé€‰é¡¹**ï¼šæ”¯æŒå¤šç§å¯¼å‡ºæ ¼å¼
- **å‚æ•°æŒä¹…åŒ–**ï¼šè®¾ç½®è‡ªåŠ¨ä¿å­˜

## ğŸ“‹ æ”¯æŒçš„å›¾æ¡ˆç±»å‹

### 1. çº¯è‰² (Solid)
- **ç”¨é€”**ï¼šåŸºç¡€é¢œè‰²å‡†ç¡®æ€§æµ‹è¯•ã€ä¼½é©¬æ ¡å‡†
- **å‚æ•°**ï¼š 
  - é¢œè‰²é€‰æ‹©ï¼ˆRGBå€¼ï¼‰
  - äº®åº¦çº§åˆ«
  - ç”¨äºè¯†åˆ«çš„é¢œè‰²æ ‡ç­¾
- **åº”ç”¨åœºæ™¯**ï¼šç™½ç‚¹æ ¡å‡†ã€é»‘ç”µå¹³æµ‹è¯•ã€é¢œè‰²å‡åŒ€æ€§

### 2. éš”è¡Œç‚¹äº® (Stripe)
- **ç”¨é€”**ï¼šå“åº”æ—¶é—´æµ‹è¯•ã€è¿åŠ¨æ¨¡ç³Šè¯„ä¼°
- **å‚æ•°**ï¼š
  - æ°´å¹³/å‚ç›´æ–¹å‘
  - æ¡çº¹å®½åº¦å’Œé—´è·
  - å‰æ™¯/èƒŒæ™¯é¢œè‰²
  - è§†åœºå®šä½
- **åº”ç”¨åœºæ™¯**ï¼šåƒç´ å“åº”æµ‹é‡ã€ä¸²æ‰°åˆ†æ

### 3. ç¯å½¢å›¾æ¡ˆ (Ring)
- **ç”¨é€”**ï¼šé•œå¤´ç•¸å˜æµ‹è¯•ã€å¯¹ç„¦ç²¾åº¦
- **å‚æ•°**ï¼š
  - ç¯å®½åº¦å’Œé—´è·
  - ä¸­å¿ƒçº¿é€‰é¡¹
  - å¤šç¯é…ç½®
  - é¢œè‰²è‡ªå®šä¹‰
- **åº”ç”¨åœºæ™¯**ï¼šå…‰å­¦ç³»ç»Ÿæ ¡å‡†ã€ç•¸å˜æµ‹é‡

### 4. MTFå›¾æ¡ˆ (MTF)
- **ç”¨é€”**ï¼šè°ƒåˆ¶ä¼ é€’å‡½æ•°æµ‹è¯•ã€åˆ†è¾¨ç‡å’Œé”åº¦æµ‹è¯•
- **å‚æ•°**ï¼š  
  - çº¿æ¡åšåº¦å’Œé•¿åº¦
  - å›¾è¡¨ç±»å‹ï¼ˆå››çº¿å¯¹ã€å€¾æ–œè¾¹ç¼˜ã€å®é©¬å›¾ï¼‰
  - å¤šæ–¹å‘
  - è‡ªå®šä¹‰çº¿å¯¹é…ç½®
- **åº”ç”¨åœºæ™¯**ï¼šç›¸æœºåˆ†è¾¨ç‡æµ‹è¯•ã€é•œå¤´æ€§èƒ½è¯„ä¼°

### 5. ä¹ç‚¹å›¾æ¡ˆ (NineDot)
- **ç”¨é€”**ï¼šå¤šç‚¹å¯¹ç„¦å’Œå¯¹é½æµ‹è¯•
- **å‚æ•°**ï¼š
  - ç‚¹å¤§å°å’Œé—´è·
  - ç½‘æ ¼å®šä½
  - é¢œè‰²é€‰æ‹©
  - è§†åœºè¦†ç›–é€‰é¡¹
- **åº”ç”¨åœºæ™¯**ï¼šå¤šç›¸æœºå¯¹é½ã€å¯¹ç„¦å‡åŒ€æ€§æµ‹è¯•

### 6. ç‚¹é˜µå›¾æ¡ˆ (Dot)
- **ç”¨é€”**ï¼šåƒç´ ç²¾åº¦å’Œå¯¹é½æµ‹è¯•
- **å‚æ•°**ï¼š
  - ç‚¹åŠå¾„å’Œé—´è·
  - è¡Œ/åˆ—æ•°ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰
  - é¢œè‰²é€‰é¡¹
  - è‡ªé€‚åº”å¤§å°è°ƒæ•´
- **åº”ç”¨åœºæ™¯**ï¼šåƒç´ æ˜ å°„ã€æ˜¾ç¤ºå™¨æ ¡å‡†

### 7. åå­—ç½‘æ ¼ (CrossGrid)
- **ç”¨é€”**ï¼šå‡ ä½•ç²¾åº¦å’Œç½‘æ ¼å¯¹é½
- **å‚æ•°**ï¼š
  - åå­—å¤§å°å’Œåšåº¦
  - ç½‘æ ¼é—´è·å’Œæ•°é‡
  - çº¿æ¡é¢œè‰²å’Œæ ·å¼
  - å®šä½æ§åˆ¶
- **åº”ç”¨åœºæ™¯**ï¼šå‡ ä½•æ ¡å‡†ã€æµ‹é‡å‚è€ƒ

### 8. åå­—å›¾æ¡ˆ (Cross)
- **ç”¨é€”**ï¼šä¸­å¿ƒå¯¹é½å’Œå®šä½å‚è€ƒ
- **å‚æ•°**ï¼š
  - æ°´å¹³/å‚ç›´çº¿å®½å’Œé•¿åº¦
  - å¤šä¸ªåå­—ä½ç½®
  - é¢œè‰²è‡ªå®šä¹‰
  - è§†åœºå®šä½
- **åº”ç”¨åœºæ™¯**ï¼šå…‰è½´å¯¹é½ã€ä¸­å¿ƒç‚¹å‚è€ƒ

### 9. æ£‹ç›˜æ ¼ (Checkerboard)
- **ç”¨é€”**ï¼šç›¸æœºæ ‡å®šå’Œç•¸å˜æ ¡æ­£
- **å‚æ•°**ï¼š
  - ç½‘æ ¼å¤§å°ï¼ˆæŒ‰æ•°é‡æˆ–å•å…ƒæ ¼å¤§å°ï¼‰
  - å•å…ƒæ ¼å°ºå¯¸
  - äº¤æ›¿é¢œè‰²
  - è§†åœºç¼©æ”¾
- **åº”ç”¨åœºæ™¯**ï¼šç›¸æœºæ ‡å®šã€3Dé‡å»º

### 10. SFRå›¾æ¡ˆ (SFR)
- **ç”¨é€”**ï¼šé«˜çº§åˆ†è¾¨ç‡å’Œé¢‘ç‡å“åº”æµ‹è¯•
- **å‚æ•°**ï¼š
  - é¢‘ç‡èŒƒå›´
  - è¾¹ç¼˜æ–¹å‘
  - å¯¹æ¯”åº¦çº§åˆ«
  - åˆ†æåŒºåŸŸ
- **åº”ç”¨åœºæ™¯**ï¼šå›¾åƒè´¨é‡è¯„ä¼°ã€é•œå¤´æµ‹è¯•

### 11. çº¿å¯¹MTF (LinePairMTF)
- **ç”¨é€”**ï¼šçº¿å¯¹å›¾æ¡ˆçš„è¯¦ç»†MTFåˆ†æ
- **å‚æ•°**ï¼š
  - çº¿å¯¹å¯†åº¦
  - å¤šæ–¹å‘å’Œè§’åº¦
  - è‡ªå®šä¹‰é—´è·é…ç½®
  - é«˜çº§å›¾è¡¨ç±»å‹
- **åº”ç”¨åœºæ™¯**ï¼šé«˜ç²¾åº¦åˆ†è¾¨ç‡æµ‹è¯•ã€å…‰å­¦å·¥ä½œå°æµ‹é‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

1. **æ‰“å¼€ Pattern æ’ä»¶**ï¼š
   ```
   ColorVision â†’ æ’ä»¶ â†’ Pattern
   ```

2. **é€‰æ‹©å›¾æ¡ˆç±»å‹**ï¼š
   - ä»å·¦ä¾§å›¾æ¡ˆåˆ—è¡¨ä¸­é€‰æ‹©
   - åœ¨ç¼–è¾‘å™¨é¢æ¿ä¸­é…ç½®å‚æ•°

3. **è®¾ç½®åˆ†è¾¨ç‡**ï¼š
   - ä»å¸¸ç”¨é¢„è®¾ä¸­é€‰æ‹©ï¼ˆ1080pã€4Kã€8Kï¼‰
   - æˆ–è¾“å…¥è‡ªå®šä¹‰å®½åº¦/é«˜åº¦å€¼

4. **ç”Ÿæˆå›¾æ¡ˆ**ï¼š
   - ç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®åˆ›å»ºå›¾æ¡ˆ
   - é¢„è§ˆå°†æ˜¾ç¤ºåœ¨ä¸»æ˜¾ç¤ºåŒºåŸŸ

5. **å¯¼å‡ºå›¾æ¡ˆ**ï¼š
   - ä½¿ç”¨"å¯¼å‡º"ä¿å­˜ä¸ºå›¾åƒæ–‡ä»¶
   - æ”¯æŒå¤šç§æ ¼å¼ï¼ˆPNGã€JPEGã€BMPï¼‰

### æ¨¡æ¿ç®¡ç†

```csharp
// å°†å½“å‰é…ç½®ä¿å­˜ä¸ºæ¨¡æ¿
PatternManager.SaveTemplate("MyCustomPattern", currentConfig);

// åŠ è½½æ¨¡æ¿
PatternManager.LoadTemplate("MyCustomPattern");

// å¯¼å‡ºæ¨¡æ¿ç»„
PatternManager.ExportTemplateGroup("MyTemplates.json");
```

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰åˆ†è¾¨ç‡

æ’ä»¶æ”¯æŒå„ç§æ ‡å‡†å’Œè‡ªå®šä¹‰åˆ†è¾¨ç‡ï¼š

```csharp
// å¯ç”¨çš„å¸¸ç”¨é¢„è®¾
("3840x2160", 3840, 2160), // 4K UHD
("1920x1080", 1920, 1080), // Full HD
("1280x720", 1280, 720),   // HD
("1024x768", 1024, 768),   // XGA
("800x600", 800, 600),     // SVGA
("640x480", 640, 480)      // VGA
```

### è§†åœºè®¾ç½®

é…ç½®å›¾æ¡ˆåœ¨æ˜¾ç¤ºåŒºåŸŸå†…çš„å®šä½ï¼š

```csharp
// åœ¨æ˜¾ç¤ºåŒºåŸŸçš„80%ä¸­å±…ä¸­å›¾æ¡ˆ
config.FieldOfViewX = 0.8;
config.FieldOfViewY = 0.8;
```

### é¢œè‰²é…ç½®

æ‰€æœ‰å›¾æ¡ˆéƒ½æ”¯æŒè‡ªå®šä¹‰é¢œè‰²æ–¹æ¡ˆï¼š

```csharp
// è®¾ç½®ä¸»è‰²å’Œè¾…è‰²
config.MainBrush = Brushes.White;   // ä¸»è‰²
config.AltBrush = Brushes.Black;    // è¾…è‰²
config.MainBrushTag = "W";          // ç™½è‰²æ ‡ç­¾
config.AltBrushTag = "K";           // é»‘è‰²æ ‡ç­¾
```

## ğŸ“š API å‚è€ƒ

### æ ¸å¿ƒæ¥å£

```csharp
public interface IPattern
{
    ViewModelBase GetConfig();
    void SetConfig(string config);
    UserControl GetPatternEditor();
    Mat Gen(int height, int width);
    string GetTemplateName();
}
```

### å›¾æ¡ˆåŸºç±»

```csharp
public abstract class IPatternBase<T> : IPatternBase where T : ViewModelBase, new()
{
    public T Config { get; set; } = new T();
    public override ViewModelBase GetConfig() => Config;
    public override void SetConfig(string config);
    public abstract UserControl GetPatternEditor();
    public abstract Mat Gen(int height, int width);
    public override string GetTemplateName();
}
```

### å›¾æ¡ˆç”Ÿæˆ

```csharp
// ç”ŸæˆæŒ‡å®šå°ºå¯¸çš„å›¾æ¡ˆ
Mat pattern = patternInstance.Gen(1920, 1080);

// è½¬æ¢ä¸ºæ˜¾ç¤ºæ ¼å¼
var bitmap = pattern.ToWriteableBitmap();
imageDisplay.SetImageSource(bitmap);
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### åˆ›å»ºè‡ªå®šä¹‰å›¾æ¡ˆ

1. **ç»§æ‰¿ IPatternBase<T>**ï¼š

```csharp
[DisplayName("è‡ªå®šä¹‰å›¾æ¡ˆ")]
public class CustomPattern : IPatternBase<CustomPatternConfig>
{
    public override UserControl GetPatternEditor() 
        => new CustomPatternEditor(Config);
    
    public override Mat Gen(int height, int width)
    {
        // å›¾æ¡ˆç”Ÿæˆé€»è¾‘
        Mat image = new Mat(height, width, MatType.CV_8UC3, Scalar.All(0));
        // ... ç”Ÿæˆå›¾æ¡ˆ ...
        return image;
    }
    
    public override string GetTemplateName()
        => $"Custom_{Config.SomeParameter}_{DateTime.Now:HHmmss}";
}
```

2. **åˆ›å»ºé…ç½®ç±»**ï¼š

```csharp
public class CustomPatternConfig : ViewModelBase, IConfig
{
    public SolidColorBrush MainBrush { get; set; } = Brushes.White;
    public int CustomParameter { get; set; } = 100;
    // ... å…¶ä»–å‚æ•° ...
}
```

3. **æ„å»ºå’Œæ³¨å†Œ**ï¼š

```bash
# æ„å»ºæ’ä»¶
msbuild Pattern.csproj /p:Configuration=Release

# å›¾æ¡ˆå°†è¢«è‡ªåŠ¨å‘ç°å’ŒåŠ è½½
```

### ä»æºç æ„å»º

```bash
# æ„å»ºæ•´ä¸ªæ’ä»¶
"C:\Program Files\Microsoft Visual Studio\2022\Preview\MSBuild\Current\Bin\msbuild.exe" ^
  ..\scgd_general_wpf.sln /t:Plugins\Pattern /p:Configuration=Release /p:Platform=x64

# æ‰“åŒ…æ’ä»¶
python ..\Scripts\build_plugin.py -t Plugins -p Pattern
```

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç”Ÿæˆ MTF æµ‹è¯•å›¾æ¡ˆ

```csharp
// åˆ›å»ºç”¨äºåˆ†è¾¨ç‡æµ‹è¯•çš„ MTF å›¾æ¡ˆ
var mtfPattern = new PatternLinePairMTF();
mtfPattern.Config.ChartType = ChartType.FourLinePair;
mtfPattern.Config.LineThickness = 2;
mtfPattern.Config.LineLength = 40;

// ç”Ÿæˆ 4K å›¾æ¡ˆ
Mat pattern = mtfPattern.Gen(2160, 3840);
```

### æ‰¹é‡ç”Ÿæˆå›¾æ¡ˆ

```csharp
// ä¸ºæµ‹è¯•åºåˆ—ç”Ÿæˆå¤šä¸ªå›¾æ¡ˆ
var patterns = new List<IPattern> 
{
    new PatternSolid { Config = { MainBrush = Brushes.White } },
    new PatternSolid { Config = { MainBrush = Brushes.Black } },
    new PatternCheckerboard { Config = { GridX = 8, GridY = 8 } },
    new PatternLinePairMTF { Config = { ChartType = ChartType.FourLinePair } }
};

foreach (var pattern in patterns)
{
    var mat = pattern.Gen(1080, 1920);
    SavePattern(mat, pattern.GetTemplateName());
}
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å›¾æ¡ˆæ— æ³•æ˜¾ç¤º**ï¼š
   - æ£€æŸ¥åˆ†è¾¨ç‡è®¾ç½®æ˜¯å¦åˆç†
   - éªŒè¯é¢œè‰²å€¼æ˜¯å¦æœ‰æ•ˆ
   - ç¡®ä¿æœ‰è¶³å¤Ÿå†…å­˜ç”¨äºå¤§å›¾æ¡ˆ

2. **æ¨¡æ¿åŠ è½½å¤±è´¥**ï¼š
   - éªŒè¯ JSON æ ¼å¼æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥æ–‡ä»¶æƒé™
   - ç¡®è®¤æ¨¡æ¿ç‰ˆæœ¬å…¼å®¹æ€§

3. **å¯¼å‡ºé—®é¢˜**ï¼š
   - æ£€æŸ¥è¾“å‡ºç›®å½•æƒé™
   - éªŒè¯å›¾åƒæ ¼å¼æ”¯æŒ
   - ç¡®ä¿æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´

### æ€§èƒ½ä¼˜åŒ–

```csharp
// å¯¹äºå¤§å›¾æ¡ˆï¼Œè€ƒè™‘ä½¿ç”¨ ROI
Rect roi = new Rect(startX, startY, roiWidth, roiHeight);
pattern.CopyTo(fullImage[roi]);

// é‡Šæ”¾ Mat å¯¹è±¡ä»¥é‡Šæ”¾å†…å­˜
using (var pattern = GeneratePattern())
{
    // ä½¿ç”¨å›¾æ¡ˆ
} // è‡ªåŠ¨é‡Šæ”¾
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼ˆ`git checkout -b feature/new-pattern`ï¼‰
3. æŒ‰ç…§ç°æœ‰çº¦å®šå®ç°æ‚¨çš„å›¾æ¡ˆ
4. æ·»åŠ é€‚å½“çš„å•å…ƒæµ‹è¯•
5. æäº¤ Pull Request

### ä»£ç è§„èŒƒ

- éµå¾ª C# å‘½åçº¦å®š
- ä¸ºå…¬å…± API ä½¿ç”¨ XML æ–‡æ¡£æ³¨é‡Š
- ä¸º OpenCV Mat å¯¹è±¡å®ç°æ­£ç¡®çš„èµ„æºé‡Šæ”¾
- ä¸º UI æ˜¾ç¤ºæ·»åŠ  DisplayName å±æ€§

## ğŸ“„ è®¸å¯è¯

æœ¬æ’ä»¶æ˜¯ ColorVision é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œé‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ä¸»é¡¹ç›®è®¸å¯è¯ã€‚

## ğŸ†˜ æ”¯æŒ

- **æ–‡æ¡£**ï¼š[ColorVision æ–‡æ¡£](../../docs/)
- **é—®é¢˜åé¦ˆ**ï¼š[GitHub Issues](https://github.com/xincheng213618/scgd_general_wpf/issues)
- **è®¨è®º**ï¼š[GitHub Discussions](https://github.com/xincheng213618/scgd_general_wpf/discussions)

---

**æ³¨æ„**ï¼šæ­¤æ’ä»¶éœ€è¦ ColorVision ç‰ˆæœ¬ 1.3.12.21 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚åœ¨ä½¿ç”¨é«˜çº§åŠŸèƒ½ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„å®‰è£…æ»¡è¶³æœ€ä½è¦æ±‚ã€‚